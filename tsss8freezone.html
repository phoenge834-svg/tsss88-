<!DOCTYPE html>
<html lang="my">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TSSS88 Ad Gallery</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg,#0a0f2c,#ffbf00);
    color:#fff;
    overflow-x:hidden;
  }
  a { color:#ffd700; text-decoration:none; }
  a:hover { text-decoration:underline; }
  header {
    text-align:center;
    padding:20px;
    background: linear-gradient(to right, #0a0f2c, #1a237e, #ffbf00);
    animation: gradientMove 10s ease infinite;
    background-size:600% 600%;
    position:relative;
  }
  @keyframes gradientMove {
    0% {background-position:0% 50%;}
    50% {background-position:100% 50%;}
    100% {background-position:0% 50%;}
  }
  header h1 {
    margin:0;
    font-size:2.5rem;
    font-weight:600;
    color:#fff;
    user-select:none;
  }
  header p { 
    margin:5px 0 0; 
    font-size:1rem;
    cursor: pointer;
    transition: all 0.3s;
  }
  header p:hover {
    color: #ffd700;
    transform: scale(1.05);
  }

  /* Bonus Groups */
  .bonus-groups-container {
    padding: 10px 20px;
    overflow-x: auto;
    white-space: nowrap;
    text-align: center;
  }
  .bonus-groups {
    display: inline-flex;
    gap: 10px;
    padding: 10px 0;
  }
  .bonus-group {
    background: rgba(255,255,255,0.1);
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
    font-weight: 600;
    font-size: 0.85rem;
    text-align: center;
    min-width: 100px;
  }
  .bonus-group:hover {
    background: rgba(255,255,255,0.2);
    transform: translateY(-3px);
  }
  .bonus-group.active {
    background: rgba(255,215,0,0.2);
    border-color: #ffd700;
    box-shadow: 0 0 15px rgba(255,215,0,0.5);
  }

  /* Gallery */
  .gallery {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-auto-rows: 150px;
    gap: 10px;
    padding: 20px;
  }
  .card {
    position: relative;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0,0,0,0.5);
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
    background: rgba(255,255,255,0.05);
    width: 100%;
    height: 100%;
  }
  .card:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 30px rgba(0,0,0,0.7);
  }
  .card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  
  /* View Count Badge */
  .view-count {
    position: absolute;
    bottom: 8px;
    left: 8px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  /* Overlay */
  .overlay {
    position:fixed; top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.9);
    display:none;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    padding:20px;
    z-index:999;
    overflow-y:auto;
  }
  .overlay img {
    max-width:90%;
    max-height:60%;
    border-radius:16px;
    margin-bottom:20px;
  }
  .overlay .caption {
    font-size:1.2rem;
    text-align:center;
    margin-bottom:20px;
  }
  .overlay button {
    padding:10px 20px;
    font-size:1rem;
    border:none;
    border-radius:8px;
    background:#ffd700;
    color:#0a0f2c;
    cursor:pointer;
    font-weight:600;
    transition:background 0.3s;
  }
  .overlay button:hover { background:#ffbf00; }

  /* Admin Panel */
  .admin-panel {
    position:fixed; top:20px; right:20px;
    background: rgba(0,0,0,0.9);
    padding:15px;
    border-radius:12px;
    display:none;
    flex-direction:column;
    gap:10px;
    z-index:1000;
    border: 2px solid #ffd700;
    min-width: 250px;
    max-height: 80vh;
    overflow-y: auto;
  }
  .admin-panel input[type="file"] { color:#fff; }
  .admin-panel input, .admin-panel textarea, .admin-panel select {
    width:100%;
    padding:8px;
    border-radius:6px;
    border:none;
    box-sizing: border-box;
  }
  .admin-panel button {
    padding:8px 12px;
    border-radius:6px;
    border:none;
    font-weight:600;
    cursor:pointer;
    transition: all 0.3s;
  }
  .admin-panel .upload-btn {
    background:#ffd700;
    color:#0a0f2c;
  }
  .admin-panel .upload-btn:hover {
    background:#ffbf00;
  }
  .admin-panel .close-btn {
    background:#e74c3c;
    color:white;
  }
  .admin-panel .close-btn:hover {
    background:#c0392b;
  }
  .admin-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  .admin-title {
    font-weight: 600;
    color: #ffd700;
  }
  .admin-close {
    background: none;
    border: none;
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Group Management */
  .group-management {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid rgba(255,255,255,0.2);
  }
  .group-management h3 {
    margin: 0 0 10px 0;
    font-size: 1rem;
    color: #ffd700;
  }
  .group-list {
    max-height: 150px;
    overflow-y: auto;
    margin-bottom: 10px;
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 6px;
    padding: 5px;
  }
  .group-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px;
    margin-bottom: 5px;
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
  }
  .group-item:last-child {
    margin-bottom: 0;
  }
  .group-actions {
    display: flex;
    gap: 5px;
  }
  .group-actions button {
    padding: 3px 6px;
    font-size: 0.7rem;
  }

  /* Contact Management */
  .contact-management {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid rgba(255,255,255,0.2);
  }
  .contact-management h3 {
    margin: 0 0 10px 0;
    font-size: 1rem;
    color: #ffd700;
  }

  footer {
    text-align:center;
    padding:10px;
    font-size:0.9rem;
    background: rgba(0,0,0,0.6);
  }

  /* Responsive */
  @media (max-width: 900px){
    .gallery { grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 600px){
    .gallery { grid-template-columns: 1fr; }
    .bonus-groups {
      flex-wrap: wrap;
      justify-content: center;
    }
    .bonus-group {
      min-width: 80px;
      font-size: 0.75rem;
      padding: 6px 12px;
    }
    .admin-panel {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 300px;
    }
  }
</style>
</head>
<body>

<header>
  <h1 id="logo">TSSS88</h1>
  <p id="contactInfo">·ÄÄ·Äº·Ä±·Ä¨·Ä∫·ÄÑ·Äº·Ä¨·Äê·ÄÑ·Ä∫·Äú·Ä≠·ÄØ·Äû·Ä∞·Äô·Äª·Ä¨·Ä∏ ‚Äì Telegram üëâ @HWH883</p>
</header>

<div class="bonus-groups-container">
  <div class="bonus-groups" id="bonusGroups">
    <!-- Groups will be dynamically generated here -->
  </div>
</div>

<div class="gallery" id="gallery"></div>

<!-- Overlay -->
<div class="overlay" id="overlay">
  <img id="overlayImg" src="" alt="">
  <div class="caption" id="overlayCaption"></div>
  <button onclick="closeOverlay()">Back</button>
</div>

<!-- Admin Panel -->
<div class="admin-panel" id="adminPanel">
  <div class="admin-header">
    <div class="admin-title">Admin Panel</div>
    <button class="admin-close" onclick="closeAdminPanel()">‚úï</button>
  </div>
  
  <h3>Upload Ad</h3>
  <input type="file" id="imgFile" multiple>
  <textarea id="imgCaption" placeholder="Caption + link"></textarea>
  <select id="bonusGroupSelect">
    <!-- Groups will be dynamically populated here -->
  </select>
  <button class="upload-btn" onclick="uploadImages()">Upload</button>
  
  <div class="group-management">
    <h3>Manage Groups</h3>
    <div class="group-list" id="groupList">
      <!-- Groups will be dynamically listed here -->
    </div>
    <div style="display: flex; gap: 5px;">
      <input type="text" id="newGroupName" placeholder="New group name" style="flex: 1;">
      <button class="upload-btn" onclick="addNewGroup()">Add</button>
    </div>
  </div>
  
  <div class="contact-management">
    <h3>Manage Contact Info</h3>
    <input type="text" id="contactText" placeholder="Contact information">
    <button class="upload-btn" onclick="updateContactInfo()">Update Contact</button>
  </div>
</div>

<footer>
  ¬© TSSS88 | Powered by Telegram @HWH883
</footer>

<script>
const PASSWORD = "meengesd834";
let images = [];
let currentGroup = "all";
let groups = ["Free Bonus", "100% Bonus", "200% Bonus", "300% Bonus"];
let contactInfo = "·ÄÄ·Äº·Ä±·Ä¨·Ä∫·ÄÑ·Äº·Ä¨·Äê·ÄÑ·Ä∫·Äú·Ä≠·ÄØ·Äû·Ä∞·Äô·Äª·Ä¨·Ä∏ ‚Äì Telegram üëâ @HWH883";

// Load data from localStorage
function loadData(){
  // Load images
  const savedImages = localStorage.getItem('tsss88_images');
  if(savedImages){
    images = JSON.parse(savedImages);
  }
  
  // Load groups
  const savedGroups = localStorage.getItem('tsss88_groups');
  if(savedGroups){
    groups = JSON.parse(savedGroups);
  }
  
  // Load contact info
  const savedContact = localStorage.getItem('tsss88_contact');
  if(savedContact){
    contactInfo = savedContact;
  }
  
  // Load view counts
  const viewCounts = localStorage.getItem('tsss88_view_counts');
  if(viewCounts){
    const counts = JSON.parse(viewCounts);
    images.forEach((img, idx) => {
      if(counts[idx] !== undefined) {
        img.views = counts[idx];
      } else {
        img.views = 0;
      }
    });
  } else {
    // Initialize view counts if not exists
    images.forEach(img => {
      img.views = 0;
    });
    saveViewCounts();
  }
  
  // Update contact info display
  document.getElementById('contactInfo').textContent = contactInfo;
}

function saveImages(){
  localStorage.setItem('tsss88_images', JSON.stringify(images));
}

function saveGroups(){
  localStorage.setItem('tsss88_groups', JSON.stringify(groups));
}

function saveContactInfo(){
  localStorage.setItem('tsss88_contact', contactInfo);
}

function saveViewCounts(){
  const viewCounts = images.map(img => img.views);
  localStorage.setItem('tsss88_view_counts', JSON.stringify(viewCounts));
}

// Long-press logo for Admin panel (mobile friendly)
let pressTimer;
const logo = document.getElementById('logo');
logo.addEventListener('mousedown', startPress);
logo.addEventListener('touchstart', startPress);
logo.addEventListener('mouseup', cancelPress);
logo.addEventListener('mouseleave', cancelPress);
logo.addEventListener('touchend', cancelPress);

function startPress(e){
  pressTimer = setTimeout(()=>{
    let pass = prompt("Enter Admin Password:");
    if(pass === PASSWORD){
      document.getElementById('adminPanel').style.display = 'flex';
      alert("Admin Panel Opened!");
      renderGallery();
      updateGroupSelect();
      renderGroupList();
      document.getElementById('contactText').value = contactInfo;
    } else { alert("Wrong Password!"); }
  },1000);
}
function cancelPress(e){ clearTimeout(pressTimer); }

// Close Admin Panel
function closeAdminPanel(){
  document.getElementById('adminPanel').style.display = 'none';
}

// Upload images
function uploadImages(){
  const files = document.getElementById('imgFile').files;
  const caption = document.getElementById('imgCaption').value;
  const groupIndex = document.getElementById('bonusGroupSelect').selectedIndex;
  const group = groups[groupIndex];
  
  if(files.length===0){ alert("Select images!"); return; }
  for(let file of files){
    const reader = new FileReader();
    reader.onload = function(e){
      images.push({src:e.target.result, caption:caption, group:group, views: 0});
      saveImages();
      saveViewCounts();
      renderGallery();
    }
    reader.readAsDataURL(file);
  }
  document.getElementById('imgCaption').value="";
  document.getElementById('imgFile').value="";
}

// Render Gallery
function renderGallery(){
  const gallery = document.getElementById('gallery');
  gallery.innerHTML='';
  
  // Filter images by current group
  const filteredImages = currentGroup === "all" 
    ? images 
    : images.filter(img => img.group === currentGroup);
  
  filteredImages.forEach((img,idx)=>{
    const card=document.createElement('div');
    card.className='card';
    const image=document.createElement('img');
    image.src=img.src;
    
    // Find original index in images array
    const originalIdx = images.findIndex(item => item.src === img.src);
    
    image.onclick=()=>openOverlay(originalIdx);
    card.appendChild(image);
    
    // Add view count badge
    const viewBadge = document.createElement('div');
    viewBadge.className = 'view-count';
    viewBadge.innerHTML = `üëÅÔ∏è ${img.views}`;
    card.appendChild(viewBadge);

    if(document.getElementById('adminPanel').style.display==='flex'){
      const del=document.createElement('span');
      del.innerText='‚ùå';
      del.style.position='absolute';
      del.style.top='5px';
      del.style.right='5px';
      del.style.cursor='pointer';
      del.style.background = 'rgba(0,0,0,0.5)';
      del.style.borderRadius = '50%';
      del.style.width = '24px';
      del.style.height = '24px';
      del.style.display = 'flex';
      del.style.alignItems = 'center';
      del.style.justifyContent = 'center';
      del.onclick=(e)=>{
        e.stopPropagation();
        const pass=prompt("Enter Password to Delete:");
        if(pass===PASSWORD){ 
          images.splice(originalIdx,1); 
          saveImages();
          saveViewCounts();
          renderGallery(); 
        } else{ alert("Wrong Password!"); }
      }
      card.appendChild(del);
    }

    gallery.appendChild(card);
  });
}

// Overlay
function openOverlay(idx){
  document.getElementById('overlayImg').src = images[idx].src;
  document.getElementById('overlayCaption').innerHTML = images[idx].caption.replace(/(https?:\/\/[^\s]+)/g,'<a href="$1" target="_blank">$1</a>');
  document.getElementById('overlay').style.display='flex';
  
  // Increment view count
  images[idx].views++;
  saveViewCounts();
  
  // Update view count in gallery
  const viewBadges = document.querySelectorAll('.view-count');
  if(viewBadges[idx]) {
    viewBadges[idx].innerHTML = `üëÅÔ∏è ${images[idx].views}`;
  }
}
function closeOverlay(){ document.getElementById('overlay').style.display='none'; }

// Bonus Group Selection
function setupBonusGroups() {
  const bonusGroupsContainer = document.getElementById('bonusGroups');
  bonusGroupsContainer.innerHTML = '';
  
  // Add "All" group
  const allGroup = document.createElement('div');
  allGroup.className = 'bonus-group active';
  allGroup.setAttribute('data-group', 'all');
  allGroup.textContent = 'All';
  allGroup.addEventListener('click', () => {
    selectGroup('all');
  });
  bonusGroupsContainer.appendChild(allGroup);
  
  // Add other groups
  groups.forEach(group => {
    const groupElement = document.createElement('div');
    groupElement.className = 'bonus-group';
    groupElement.setAttribute('data-group', group);
    groupElement.textContent = group;
    groupElement.addEventListener('click', () => {
      selectGroup(group);
    });
    bonusGroupsContainer.appendChild(groupElement);
  });
}

function selectGroup(group) {
  currentGroup = group;
  
  // Update active state
  const groupElements = document.querySelectorAll('.bonus-group');
  groupElements.forEach(el => {
    if(el.getAttribute('data-group') === group) {
      el.classList.add('active');
    } else {
      el.classList.remove('active');
    }
  });
  
  // Re-render gallery
  renderGallery();
}

// Update group select in admin panel
function updateGroupSelect() {
  const select = document.getElementById('bonusGroupSelect');
  select.innerHTML = '';
  
  groups.forEach(group => {
    const option = document.createElement('option');
    option.value = group;
    option.textContent = group;
    select.appendChild(option);
  });
}

// Render group list in admin panel
function renderGroupList() {
  const groupList = document.getElementById('groupList');
  groupList.innerHTML = '';
  
  groups.forEach((group, index) => {
    const groupItem = document.createElement('div');
    groupItem.className = 'group-item';
    
    const groupName = document.createElement('span');
    groupName.textContent = group;
    
    const groupActions = document.createElement('div');
    groupActions.className = 'group-actions';
    
    const editBtn = document.createElement('button');
    editBtn.className = 'upload-btn';
    editBtn.textContent = 'Edit';
    editBtn.onclick = () => editGroup(index);
    
    const deleteBtn = document.createElement('button');
    deleteBtn.className = 'close-btn';
    deleteBtn.textContent = 'Delete';
    deleteBtn.onclick = () => deleteGroup(index);
    
    groupActions.appendChild(editBtn);
    groupActions.appendChild(deleteBtn);
    
    groupItem.appendChild(groupName);
    groupItem.appendChild(groupActions);
    
    groupList.appendChild(groupItem);
  });
}

// Add new group
function addNewGroup() {
  const newGroupName = document.getElementById('newGroupName').value.trim();
  if (!newGroupName) {
    alert('Please enter a group name');
    return;
  }
  
  if (groups.includes(newGroupName)) {
    alert('Group already exists');
    return;
  }
  
  groups.push(newGroupName);
  saveGroups();
  setupBonusGroups();
  updateGroupSelect();
  renderGroupList();
  
  document.getElementById('newGroupName').value = '';
}

// Edit group
function editGroup(index) {
  const newName = prompt('Enter new group name:', groups[index]);
  if (newName && newName.trim()) {
    const oldName = groups[index];
    groups[index] = newName.trim();
    
    // Update images that belong to this group
    images.forEach(img => {
      if (img.group === oldName) {
        img.group = newName.trim();
      }
    });
    
    saveGroups();
    saveImages();
    setupBonusGroups();
    updateGroupSelect();
    renderGroupList();
    renderGallery();
  }
}

// Delete group
function deleteGroup(index) {
  if (groups.length <= 1) {
    alert('You must have at least one group');
    return;
  }
  
  if (!confirm(`Are you sure you want to delete "${groups[index]}"?`)) {
    return;
  }
  
  const deletedGroup = groups[index];
  groups.splice(index, 1);
  
  // Move images from deleted group to the first available group
  const firstGroup = groups[0];
  images.forEach(img => {
    if (img.group === deletedGroup) {
      img.group = firstGroup;
    }
  });
  
  saveGroups();
  saveImages();
  setupBonusGroups();
  updateGroupSelect();
  renderGroupList();
  renderGallery();
}

// Update contact information
function updateContactInfo() {
  const newContact = document.getElementById('contactText').value.trim();
  if (!newContact) {
    alert('Please enter contact information');
    return;
  }
  
  contactInfo = newContact;
  saveContactInfo();
  document.getElementById('contactInfo').textContent = contactInfo;
  alert('Contact information updated successfully!');
}

// Initialize
loadData();
setupBonusGroups();
renderGallery();
</script>

</body>
</html>